spring:
  application:
    name: cafe-erp

  datasource:
    url: jdbc:postgresql://localhost:5432/cafe_erp
    username: cafe_user
    password: cafe_pass_2025
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      idle-timeout: 300000
      connection-timeout: 20000

  jpa:
    hibernate:
      ddl-auto: validate        # Flyway manages schema — never use create/update
    show-sql: false
    properties:
      hibernate:
        format_sql: true
        dialect: org.hibernate.dialect.PostgreSQLDialect
        jdbc:
          batch_size: 50
        order_inserts: true
        order_updates: true

  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true

  data:
    redis:
      host: localhost
      port: 6379
      password: redis_pass_2025
      lettuce:
        pool:
          max-active: 10
          max-idle: 5

  jackson:
    time-zone: Africa/Cairo
    serialization:
      write-dates-as-timestamps: false

  mail:
    host: smtp.gmail.com
    port: 587
    username: ${MAIL_USERNAME:your@gmail.com}
    password: ${MAIL_PASSWORD:yourapppassword}
    properties:
      mail.smtp.auth: true
      mail.smtp.starttls.enable: true

server:
  port: 8080
  servlet:
    context-path: /api/v1

# ── App-specific config ──────────────────────────────────
app:
  jwt:
    secret: ${JWT_SECRET:cafe-erp-super-secret-key-change-in-production-2025}
    access-token-expiry-ms: 900000          # 15 minutes
    refresh-token-expiry-ms: 604800000      # 7 days

  cafe:
    name: "My Cafe"
    address: "Cairo, Egypt"
    phone: "+20-10-0000-0000"
    tax-number: ""
    currency: "EGP"
    timezone: "Africa/Cairo"

  loyalty:
    points-per-100-egp: 10
    egp-per-100-points: 10
    points-validity-days: 180
    bronze-threshold: 0
    silver-threshold: 500
    gold-threshold: 1500

  gaming:
    min-session-minutes: 15             # Less than this → charged as 15 min
    long-session-alert-hours: 3         # Alert supervisor after 3 hrs

  inventory:
    low-stock-notification: true

  notification:
    whatsapp:
      enabled: false
      api-url: ${WHATSAPP_API_URL:}
      api-token: ${WHATSAPP_API_TOKEN:}
      owner-phone: ${OWNER_PHONE:+20100000000}

logging:
  level:
    com.cafe.erp: DEBUG
    org.springframework.security: INFO
    org.flywaydb: INFO
